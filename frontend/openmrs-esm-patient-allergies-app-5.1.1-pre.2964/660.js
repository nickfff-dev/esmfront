(globalThis.webpackChunk_openmrs_esm_patient_allergies_app=globalThis.webpackChunk_openmrs_esm_patient_allergies_app||[]).push([[660],{2557:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o});var a=r(272),n=r.n(a),l=r(2609),i=r.n(l)()(n());i.push([e.id,":root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79}.-esm-patient-allergies__allergies-detailed-summary__widgetCard___h_2Ps{border:1px solid #e0e0e0}.-esm-patient-allergies__allergies-detailed-summary__allergyCriticality___oKFHF{display:flex;align-items:center;text-transform:uppercase}.-esm-patient-allergies__allergies-detailed-summary__allergySeverityHigh___BXOA1{font-weight:800}","",{version:3,sources:["webpack://./../../node_modules/@openmrs/esm-styleguide/src/_vars.scss","webpack://./src/allergies/allergies-detailed-summary.scss"],names:[],mappings:"AAoDA,MACE,mBAAA,CACA,mBAAA,CACA,mBAAA,CCnDF,wEACE,wBAAA,CAGF,gFACE,YAAA,CACA,kBAAA,CACA,wBAAA,CAGF,iFACE,eAAA",sourceRoot:""}]),i.locals={widgetCard:"-esm-patient-allergies__allergies-detailed-summary__widgetCard___h_2Ps",allergyCriticality:"-esm-patient-allergies__allergies-detailed-summary__allergyCriticality___oKFHF",allergySeverityHigh:"-esm-patient-allergies__allergies-detailed-summary__allergySeverityHigh___BXOA1"};const o=i},2435:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o});var a=r(272),n=r.n(a),l=r(2609),i=r.n(l)()(n());i.push([e.id,":root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79}:root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79}.-esm-patient-allergies__allergy-form__productiveHeading01___jVHlb{font-size:var(--cds-heading-compact-01-font-size, 0.875rem);font-weight:var(--cds-heading-compact-01-font-weight, 600);line-height:var(--cds-heading-compact-01-line-height, 1.28572);letter-spacing:var(--cds-heading-compact-01-letter-spacing, 0.16px)}.-esm-patient-allergies__allergy-form__productiveHeading02___AqkSP{font-size:var(--cds-heading-compact-02-font-size, 1rem);font-weight:var(--cds-heading-compact-02-font-weight, 600);line-height:var(--cds-heading-compact-02-line-height, 1.375);letter-spacing:var(--cds-heading-compact-02-letter-spacing, 0)}.-esm-patient-allergies__allergy-form__productiveHeading03___Dz8TI{font-size:var(--cds-heading-03-font-size, 1.25rem);font-weight:var(--cds-heading-03-font-weight, 400);line-height:var(--cds-heading-03-line-height, 1.4);letter-spacing:var(--cds-heading-03-letter-spacing, 0)}.-esm-patient-allergies__allergy-form__productiveHeading04___O3iLB{font-size:var(--cds-heading-04-font-size, 1.75rem);font-weight:var(--cds-heading-04-font-weight, 400);line-height:var(--cds-heading-04-line-height, 1.28572);letter-spacing:var(--cds-heading-04-letter-spacing, 0)}.-esm-patient-allergies__allergy-form__productiveHeading05___HYHD4{font-size:var(--cds-heading-05-font-size, 2rem);font-weight:var(--cds-heading-05-font-weight, 400);line-height:var(--cds-heading-05-line-height, 1.25);letter-spacing:var(--cds-heading-05-letter-spacing, 0)}.-esm-patient-allergies__allergy-form__productiveHeading06___EpNh_{font-size:var(--cds-heading-06-font-size, 2.625rem);font-weight:var(--cds-heading-06-font-weight, 300);line-height:var(--cds-heading-06-line-height, 1.199);letter-spacing:var(--cds-heading-06-letter-spacing, 0)}.-esm-patient-allergies__allergy-form__bodyShort01___b4MZO{font-size:var(--cds-body-compact-01-font-size, 0.875rem);font-weight:var(--cds-body-compact-01-font-weight, 400);line-height:var(--cds-body-compact-01-line-height, 1.28572);letter-spacing:var(--cds-body-compact-01-letter-spacing, 0.16px)}.-esm-patient-allergies__allergy-form__bodyShort02___GvHHe{font-size:var(--cds-body-compact-02-font-size, 1rem);font-weight:var(--cds-body-compact-02-font-weight, 400);line-height:var(--cds-body-compact-02-line-height, 1.375);letter-spacing:var(--cds-body-compact-02-letter-spacing, 0)}.-esm-patient-allergies__allergy-form__bodyLong01___g6fq0{font-size:var(--cds-body-01-font-size, 0.875rem);font-weight:var(--cds-body-01-font-weight, 400);line-height:var(--cds-body-01-line-height, 1.42857);letter-spacing:var(--cds-body-01-letter-spacing, 0.16px)}.-esm-patient-allergies__allergy-form__bodyLong02___Rzjzc{font-size:var(--cds-body-02-font-size, 1rem);font-weight:var(--cds-body-02-font-weight, 400);line-height:var(--cds-body-02-line-height, 1.5);letter-spacing:var(--cds-body-02-letter-spacing, 0)}.-esm-patient-allergies__allergy-form__label01___KyOYB{font-size:var(--cds-label-01-font-size, 0.75rem);font-weight:var(--cds-label-01-font-weight, 400);line-height:var(--cds-label-01-line-height, 1.33333);letter-spacing:var(--cds-label-01-letter-spacing, 0.32px)}.-esm-patient-allergies__allergy-form__header___QZLSQ{border-bottom:.0625rem solid #e0e0e0;margin:0}.-esm-patient-allergies__allergy-form__content___BiJ1K{display:grid;grid-template-columns:50% 10% 1fr;margin:.5rem 1rem}.-esm-patient-allergies__allergy-form__container___azun6{border:solid 1px #e0e0e0;margin:0rem 1rem 1rem}.-esm-patient-allergies__allergy-form__container___azun6:first-of-type{margin-bottom:2rem}.-esm-patient-allergies__allergy-form__container___azun6:last-of-type{margin-top:2.5rem}.-esm-patient-allergies__allergy-form__heading___Y2mIr{font-size:var(--cds-heading-03-font-size, 1.25rem);font-weight:var(--cds-heading-03-font-weight, 400);line-height:var(--cds-heading-03-line-height, 1.4);letter-spacing:var(--cds-heading-03-letter-spacing, 0);margin:1rem 1rem .5rem}.-esm-patient-allergies__allergy-form__section___cQIuG:not(:first-of-type){margin-bottom:2rem}.-esm-patient-allergies__allergy-form__wrapperContainer___sEcVG fieldset{display:grid;grid-template-columns:1fr 1fr;width:100%}.-esm-patient-allergies__allergy-form__wrapperContainer___sEcVG .cds--radio-button__label{justify-content:flex-start}.-esm-patient-allergies__allergy-form__tablist___JWVw1 .cds--tab--list{justify-content:center;width:100%}.-esm-patient-allergies__allergy-form__tab___XwK7G{flex-grow:1}.-esm-patient-allergies__allergy-form__sectionHeading___pzf6h{font-size:var(--cds-heading-compact-02-font-size, 1rem);font-weight:var(--cds-heading-compact-02-font-weight, 600);line-height:var(--cds-heading-compact-02-line-height, 1.375);letter-spacing:var(--cds-heading-compact-02-letter-spacing, 0);margin:1rem 1rem .5rem}.-esm-patient-allergies__allergy-form__midSectionHeading___Fb7nc{font-size:var(--cds-heading-compact-02-font-size, 1rem);font-weight:var(--cds-heading-compact-02-font-weight, 600);line-height:var(--cds-heading-compact-02-line-height, 1.375);letter-spacing:var(--cds-heading-compact-02-letter-spacing, 0);margin:0rem 1rem .5rem}.-esm-patient-allergies__allergy-form__radio___cCJp1{margin:1rem 0rem}.-esm-patient-allergies__allergy-form__radio___cCJp1 label{justify-content:flex-start}.-esm-patient-allergies__allergy-form__checkbox___A9usx:not(:first-child){margin:.3rem 0rem}.-esm-patient-allergies__allergy-form__input___RQrII{margin:0rem 1rem 1rem}.-esm-patient-allergies__allergy-form__checkboxContainer___EHQjt{display:grid;grid-template-columns:1fr 1fr}.-esm-patient-allergies__allergy-form__wrapper___BZ3jn{margin:1rem}.-esm-patient-allergies__allergy-form__wrapper___BZ3jn:last-of-type{margin-top:1.5rem}.-esm-patient-allergies__allergy-form__button___WnjB1{height:4rem;display:flex;align-content:flex-start;align-items:baseline;min-width:50%}.-esm-patient-allergies__allergy-form__tablet___p6TGp{padding:0rem}.-esm-patient-allergies__allergy-form__desktopButtons___Xmt1r{margin-top:2rem}.-esm-patient-allergies__allergy-form__tabletButtons___rIW7a{margin-top:2rem;padding:1.5rem 1rem;background-color:#fff}.-esm-patient-allergies__allergy-form__desktop___bF4ok{padding:0rem}.-esm-patient-allergies__allergy-form__form___ri4Rk{display:flex;flex-direction:column;justify-content:space-between}.-esm-patient-allergies__allergy-form__desktopContainer___PiWdJ{background-color:#f4f4f4}.-esm-patient-allergies__allergy-form__tabletContainer___oQ07C{background-color:#fff}.omrs-breakpoint-gt-tablet .-esm-patient-allergies__allergy-form__form___ri4Rk{height:calc(100vh - 6rem)}.omrs-breakpoint-gt-tablet .-esm-patient-allergies__allergy-form__section___cQIuG:last-of-type{margin-top:2rem}.omrs-breakpoint-lt-desktop .-esm-patient-allergies__allergy-form__form___ri4Rk{height:calc(100vh - 9rem)}.omrs-breakpoint-lt-desktop .-esm-patient-allergies__allergy-form__section___cQIuG:last-of-type{margin-top:0rem}","",{version:3,sources:["webpack://./../../node_modules/@openmrs/esm-styleguide/src/_vars.scss","webpack://./src/root.scss","webpack://./../../node_modules/@carbon/type/scss/_styles.scss","webpack://./src/allergies/allergies-form/allergy-form.scss"],names:[],mappings:"AAoDA,MACE,mBAAA,CACA,mBAAA,CACA,mBAAA,CAHF,MACE,mBAAA,CACA,mBAAA,CACA,mBAAA,CCnDF,mECs0BI,2DAAA,CAAA,0DAAA,CAAA,8DAAA,CAAA,mEAAA,CDl0BJ,mECk0BI,uDAAA,CAAA,0DAAA,CAAA,4DAAA,CAAA,8DAAA,CD9zBJ,mEC8zBI,kDAAA,CAAA,kDAAA,CAAA,kDAAA,CAAA,sDAAA,CD1zBJ,mEC0zBI,kDAAA,CAAA,kDAAA,CAAA,sDAAA,CAAA,sDAAA,CDtzBJ,mECszBI,+CAAA,CAAA,kDAAA,CAAA,mDAAA,CAAA,sDAAA,CDlzBJ,mECkzBI,mDAAA,CAAA,kDAAA,CAAA,oDAAA,CAAA,sDAAA,CD9yBJ,2DC8yBI,wDAAA,CAAA,uDAAA,CAAA,2DAAA,CAAA,gEAAA,CD1yBJ,2DC0yBI,oDAAA,CAAA,uDAAA,CAAA,yDAAA,CAAA,2DAAA,CDtyBJ,0DCsyBI,gDAAA,CAAA,+CAAA,CAAA,mDAAA,CAAA,wDAAA,CDlyBJ,0DCkyBI,4CAAA,CAAA,+CAAA,CAAA,+CAAA,CAAA,mDAAA,CD9xBJ,uDC8xBI,gDAAA,CAAA,gDAAA,CAAA,oDAAA,CAAA,yDAAA,CCr0BJ,sDACE,oCAAA,CACA,QAAA,CAGF,uDACE,YAAA,CACA,iCAAA,CACA,iBAAA,CAGF,yDACE,wBAAA,CACA,qBAAA,CAEA,uEACE,kBAAA,CAGF,sEACE,iBAAA,CAIJ,uDD6yBI,kDAAA,CAAA,kDAAA,CAAA,kDAAA,CAAA,sDAAA,CC3yBF,sBAAA,CAIA,2EACE,kBAAA,CAIJ,yEACE,YAAA,CACA,6BAAA,CACA,UAAA,CAGF,0FACE,0BAAA,CAIA,uEACE,sBAAA,CACA,UAAA,CAIJ,mDACE,WAAA,CAGF,8DD6wBI,uDAAA,CAAA,0DAAA,CAAA,4DAAA,CAAA,8DAAA,CC3wBF,sBAAA,CAGF,iEDwwBI,uDAAA,CAAA,0DAAA,CAAA,4DAAA,CAAA,8DAAA,CCtwBF,sBAAA,CAGF,qDACE,gBAAA,CAEA,2DACE,0BAAA,CAKF,0EACE,iBAAA,CAIJ,qDACE,qBAAA,CAGF,iEACE,YAAA,CACA,6BAAA,CAGF,uDACE,WAAA,CAEA,oEACE,iBAAA,CAIJ,sDACE,WAAA,CACA,YAAA,CACA,wBAAA,CACA,oBAAA,CACA,aAAA,CAGF,sDACE,YAAA,CAGF,8DACE,eAAA,CAGF,6DACE,eAAA,CACA,mBAAA,CACA,qBHxHM,CG2HR,uDACE,YAAA,CAGF,oDACE,YAAA,CACA,qBAAA,CACA,6BAAA,CAGF,gEACE,wBHvIM,CG0IR,+DACE,qBAAA,CAKA,+EACE,yBAAA,CAIA,+FACE,eAAA,CAOJ,gFACE,yBAAA,CAIA,gGACE,eAAA",sourceRoot:""}]),i.locals={productiveHeading01:"-esm-patient-allergies__allergy-form__productiveHeading01___jVHlb",productiveHeading02:"-esm-patient-allergies__allergy-form__productiveHeading02___AqkSP",productiveHeading03:"-esm-patient-allergies__allergy-form__productiveHeading03___Dz8TI",productiveHeading04:"-esm-patient-allergies__allergy-form__productiveHeading04___O3iLB",productiveHeading05:"-esm-patient-allergies__allergy-form__productiveHeading05___HYHD4",productiveHeading06:"-esm-patient-allergies__allergy-form__productiveHeading06___EpNh_",bodyShort01:"-esm-patient-allergies__allergy-form__bodyShort01___b4MZO",bodyShort02:"-esm-patient-allergies__allergy-form__bodyShort02___GvHHe",bodyLong01:"-esm-patient-allergies__allergy-form__bodyLong01___g6fq0",bodyLong02:"-esm-patient-allergies__allergy-form__bodyLong02___Rzjzc",label01:"-esm-patient-allergies__allergy-form__label01___KyOYB",header:"-esm-patient-allergies__allergy-form__header___QZLSQ",content:"-esm-patient-allergies__allergy-form__content___BiJ1K",container:"-esm-patient-allergies__allergy-form__container___azun6",heading:"-esm-patient-allergies__allergy-form__heading___Y2mIr",section:"-esm-patient-allergies__allergy-form__section___cQIuG",wrapperContainer:"-esm-patient-allergies__allergy-form__wrapperContainer___sEcVG",tablist:"-esm-patient-allergies__allergy-form__tablist___JWVw1",tab:"-esm-patient-allergies__allergy-form__tab___XwK7G",sectionHeading:"-esm-patient-allergies__allergy-form__sectionHeading___pzf6h",midSectionHeading:"-esm-patient-allergies__allergy-form__midSectionHeading___Fb7nc",radio:"-esm-patient-allergies__allergy-form__radio___cCJp1",checkbox:"-esm-patient-allergies__allergy-form__checkbox___A9usx",input:"-esm-patient-allergies__allergy-form__input___RQrII",checkboxContainer:"-esm-patient-allergies__allergy-form__checkboxContainer___EHQjt",wrapper:"-esm-patient-allergies__allergy-form__wrapper___BZ3jn",button:"-esm-patient-allergies__allergy-form__button___WnjB1",tablet:"-esm-patient-allergies__allergy-form__tablet___p6TGp",desktopButtons:"-esm-patient-allergies__allergy-form__desktopButtons___Xmt1r",tabletButtons:"-esm-patient-allergies__allergy-form__tabletButtons___rIW7a",desktop:"-esm-patient-allergies__allergy-form__desktop___bF4ok",form:"-esm-patient-allergies__allergy-form__form___ri4Rk",desktopContainer:"-esm-patient-allergies__allergy-form__desktopContainer___PiWdJ",tabletContainer:"-esm-patient-allergies__allergy-form__tabletContainer___oQ07C"};const o=i},910:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o});var a=r(272),n=r.n(a),l=r(2609),i=r.n(l)()(n());i.push([e.id,":root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79}.-esm-patient-allergies__allergies-tile__label___dMfkW{font-size:var(--cds-label-01-font-size, 0.75rem);font-weight:var(--cds-label-01-font-weight, 400);line-height:var(--cds-label-01-line-height, 1.33333);letter-spacing:var(--cds-label-01-letter-spacing, 0.32px);color:#525252}.-esm-patient-allergies__allergies-tile__content____n5Gu{font-size:var(--cds-body-compact-01-font-size, 0.875rem);font-weight:var(--cds-body-compact-01-font-weight, 400);line-height:var(--cds-body-compact-01-line-height, 1.28572);letter-spacing:var(--cds-body-compact-01-letter-spacing, 0.16px);color:#525252;margin-top:5px}.-esm-patient-allergies__allergies-tile__value___qWVfJ{font-size:var(--cds-body-compact-01-font-size, 0.875rem);font-weight:var(--cds-body-compact-01-font-weight, 400);line-height:var(--cds-body-compact-01-line-height, 1.28572);letter-spacing:var(--cds-body-compact-01-letter-spacing, 0.16px)}","",{version:3,sources:["webpack://./../../node_modules/@openmrs/esm-styleguide/src/_vars.scss","webpack://./src/allergies/allergies-tile.scss","webpack://./../../node_modules/@carbon/type/scss/_styles.scss"],names:[],mappings:"AAoDA,MACE,mBAAA,CACA,mBAAA,CACA,mBAAA,CCpDF,uDCu0BI,gDAAA,CAAA,gDAAA,CAAA,oDAAA,CAAA,yDAAA,CDr0BF,aAAA,CAGF,yDCk0BI,wDAAA,CAAA,uDAAA,CAAA,2DAAA,CAAA,gEAAA,CDh0BF,aDLQ,CCMR,cAAA,CAGF,uDC4zBI,wDAAA,CAAA,uDAAA,CAAA,2DAAA,CAAA,gEAAA",sourceRoot:""}]),i.locals={label:"-esm-patient-allergies__allergies-tile__label___dMfkW",content:"-esm-patient-allergies__allergies-tile__content____n5Gu",value:"-esm-patient-allergies__allergies-tile__value___qWVfJ"};const o=i},9660:(e,t,r)=>{"use strict";r.r(t),r.d(t,{allergiesDashboardLink:()=>ne,allergiesDetailedSummary:()=>ae,allergiesForm:()=>le,allergyTile:()=>ie,importTranslation:()=>$,startupApp:()=>ee});var a=r(2870),n=r(4556),l={concepts:{drugAllergenUuid:{_type:a.Type.ConceptUuid,_default:"162552AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"},environmentalAllergenUuid:{_type:a.Type.ConceptUuid,_default:"162554AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"},foodAllergenUuid:{_type:a.Type.ConceptUuid,_default:"162553AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"},mildReactionUuid:{_type:a.Type.ConceptUuid,_default:"1498AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"},moderateReactionUuid:{_type:a.Type.ConceptUuid,_default:"1499AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"},severeReactionUuid:{_type:a.Type.ConceptUuid,_default:"1500AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"},allergyReactionUuid:{_type:a.Type.ConceptUuid,_default:"162555AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"},otherConceptUuid:{_type:a.Type.ConceptUuid,_default:"5622AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"}}},i=r(7900),o=r.n(i),s=r(2779),A=r.n(s),c=r(4924),d=r(7572),_=r(8871),g=r(3255),m=r(3315);function p(e){var t,r="".concat(a.fhirBaseUrl,"/AllergyIntolerance?patient=").concat(e),n=(0,g.ZP)(e?r:null,a.openmrsFetch),l=n.data,i=n.error,o=n.isLoading,s=n.isValidating,A=n.mutate,c=(null==l||null===(t=l.data)||void 0===t?void 0:t.total)>0?null==l?void 0:l.data.entry.map((function(e){var t;return null!==(t=e.resource)&&void 0!==t?t:[]})).map(u).sort((function(e,t){return t.lastUpdated>e.lastUpdated?1:-1})):null;return{allergies:l?c:null,isError:i,isLoading:o,isValidating:s,mutate:A}}function u(e){var t,r,a,n,l,i,o,s,A,c,d,_,g,p,u,f=null==e||null===(r=e.reaction[0])||void 0===r||null===(t=r.manifestation)||void 0===t?void 0:t.map((function(e){var t;return null===(t=e.coding[0])||void 0===t?void 0:t.display}));return{id:null==e?void 0:e.id,clinicalStatus:null==e||null===(n=e.clinicalStatus)||void 0===n||null===(a=n.coding[0])||void 0===a?void 0:a.display,criticality:null==e?void 0:e.criticality,display:null==e||null===(i=e.code)||void 0===i||null===(l=i.coding[0])||void 0===l?void 0:l.display,recordedDate:null==e?void 0:e.recordedDate,recordedBy:null==e||null===(o=e.recorder)||void 0===o?void 0:o.display,recorderType:null==e||null===(s=e.recorder)||void 0===s?void 0:s.type,note:null==e||null===(c=e.note)||void 0===c||null===(A=c[0])||void 0===A?void 0:A.text,reactionToSubstance:null==e||null===(g=e.reaction[0])||void 0===g||null===(_=g.substance)||void 0===_||null===(d=_.coding[1])||void 0===d?void 0:d.display,reactionManifestations:f,reactionSeverity:(0,m.Z)(null==e||null===(p=e.reaction[0])||void 0===p?void 0:p.severity),lastUpdated:null==e||null===(u=e.meta)||void 0===u?void 0:u.lastUpdated}}var f=r(1354),y=r.n(f),C=r(1583),h=r.n(C),v=r(7378),b=r.n(v),E=r(5993),D=r.n(E),w=r(4154),k=r.n(w),B=r(8141),S=r.n(B),O=r(2557),z={};z.styleTagTransform=S(),z.setAttributes=D(),z.insert=b().bind(null,"head"),z.domAPI=h(),z.insertStyleElement=k(),y()(O.Z,z);const j=O.Z&&O.Z.locals?O.Z.locals:void 0;function R(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function F(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},a=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),a.forEach((function(t){R(e,t,r[t])}))}return e}var T=r(195),H=r(8883),I=r(3955),N=r(9198),x=r.n(N),U=r(2435),P={};P.styleTagTransform=S(),P.setAttributes=D(),P.insert=b().bind(null,"head"),P.domAPI=h(),P.insertStyleElement=k(),y()(U.Z,P);const G=U.Z&&U.Z.locals?U.Z.locals:void 0;function L(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function J(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,l=[],i=!0,o=!1;try{for(r=r.call(e);!(i=(a=r.next()).done)&&(l.push(a.value),!t||l.length!==t);i=!0);}catch(e){o=!0,n=e}finally{try{i||null==r.return||r.return()}finally{if(o)throw n}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return L(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(r):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?L(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var W=T.z.object({selectedAllergen:T.z.string(),nonCodedAllergenType:T.z.string().optional(),allergicReactions:T.z.array(T.z.string().optional()),nonCodedAllergicReaction:T.z.string().optional(),severityOfWorstReaction:T.z.string(),comment:T.z.string().optional()});function Z(e){var t=e.children;return e.isTablet?o().createElement(d.mh4,null,t," "):o().createElement(o().Fragment,null,t)}function Q(e){var t=e.allergensAndAllergicReactions,r=e.methods,a=r.control,n=r.setValue,l=(0,i.useCallback)((function(e,t,r,a){e(r),n("allergicReactions.".concat(a),t?r:"",{shouldValidate:!0})}),[n]),s=t.allergicReactions.map((function(e,t){return o().createElement(I.Qr,{key:e.uuid,name:"allergicReactions.".concat(t),control:a,defaultValue:"",render:function(r){var a=r.field,n=a.onBlur,i=a.onChange,s=a.value;return o().createElement(d.XZJ,{className:G.checkbox,labelText:e.display,id:e.uuid,onChange:function(e,r){var a=r.checked,n=r.id;l(i,a,n,t)},checked:Boolean(s),onBlur:n})}})}));return o().createElement(o().Fragment,null,s)}var M=r(910),V={};V.styleTagTransform=S(),V.setAttributes=D(),V.insert=b().bind(null,"head"),V.domAPI=h(),V.insertStyleElement=k(),y()(M.Z,V);const Y=M.Z&&M.Z.locals?M.Z.locals:void 0;function q(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var K="@openmrs/esm-patient-allergies-app",X={featureName:"patient-allergies",moduleName:K},$=r(3979);function ee(){(0,a.messageOmrsServiceWorker)({type:"registerDynamicRoute",pattern:".+/ws/rest/v1/concept.+"}),(0,a.messageOmrsServiceWorker)({type:"registerDynamicRoute",pattern:".+/ws/rest/v1/patient/.+/allergy.+"}),(0,a.messageOmrsServiceWorker)({type:"registerDynamicRoute",pattern:".+".concat(a.fhirBaseUrl,"/AllergyIntolerance.+")}),(0,a.defineConfigSchema)(K,l)}var te,re,ae=(0,a.getSyncLifecycle)((function(e){var t=e.patient,r=(0,c.useTranslation)().t,l=r("allergyIntolerances","allergy intolerances"),i=r("allergies","Allergies"),s=p(t.id),g=s.allergies,m=s.isError,u=s.isLoading,f=s.isValidating,y=(0,a.useLayoutType)(),C="tablet"===y,h="small-desktop"===y||"large-desktop"===y,v=o().useCallback((function(){return(0,n.launchPatientWorkspace)("patient-allergy-form-workspace")}),[]),b=[{key:"display",header:r("allergen","Allergen")},{key:"criticality",header:r("severityandReaction","Severity")},{key:"reaction",header:r("reaction","Reaction")},{key:"note",header:r("onsetDateAndComments","Onset date and comments")}],E=o().useMemo((function(){return null==g?void 0:g.map((function(e){var t,r;return function(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r.push.apply(r,a)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}(F({},e),{criticality:{content:o().createElement("span",{className:j.allergyCriticality},"high"===e.criticality&&o().createElement("svg",{className:"omrs-icon omrs-margin-right-4",fill:"rgba(181, 7, 6, 1)",style:{height:"1.25rem"}},o().createElement("use",{xlinkHref:"#omrs-icon-important-notification"})),o().createElement("span",{className:A()(R({},j.allergySeverityHigh,"high"===e.criticality))},e.criticality))},lastUpdated:e.lastUpdated?(0,a.formatDate)((0,a.parseDate)(e.lastUpdated),{time:!1}):"--",reaction:null===(t=e.reactionManifestations)||void 0===t?void 0:t.join(", "),note:null!==(r=null==e?void 0:e.note)&&void 0!==r?r:"--"})}))}),[g]);return u?o().createElement(d.gqd,{role:"progressbar",compact:h,zebra:!0}):m?o().createElement(n.ErrorState,{error:m,headerTitle:i}):(null==g?void 0:g.length)?o().createElement("div",{className:j.widgetCard},o().createElement(n.CardHeader,{title:i},o().createElement("span",null,f?o().createElement(d.lSo,null):null),o().createElement(d.zxk,{kind:"ghost",renderIcon:function(e){return o().createElement(_.mm,F({size:16},e))},iconDescription:"Add allergies",onClick:v},r("add","Add"))),o().createElement(d.wQF,{rows:E,headers:b,isSortable:!0,useZebraStyles:!0,size:C?"lg":"sm"},(function(e){var t=e.rows,r=e.headers,a=e.getHeaderProps,n=e.getTableProps;return o().createElement(d.xJi,null,o().createElement(d.iA_,n(),o().createElement(d.ssF,null,o().createElement(d.SCH,null,r.map((function(e){var t,r;return o().createElement(d.xDH,F({className:A()(j.productiveHeading01,j.text02)},a({header:e,isSortable:e.isSortable})),null!==(r=null===(t=e.header)||void 0===t?void 0:t.content)&&void 0!==r?r:e.header)})))),o().createElement(d.RMI,{"data-testid":"allergy-table"},t.map((function(e){return o().createElement(d.SCH,{key:e.id},e.cells.map((function(e){var t,r;return o().createElement(d.pj1,{key:e.id},null!==(r=null===(t=e.value)||void 0===t?void 0:t.content)&&void 0!==r?r:e.value)})))})))))}))):o().createElement(n.EmptyState,{displayText:l,headerTitle:i,launchForm:v})}),X),ne=(0,a.getSyncLifecycle)((0,n.createDashboardLink)((te=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},a=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),a.forEach((function(t){q(e,t,r[t])}))}return e}({},{slot:"patient-chart-allergies-dashboard-slot",columns:1,path:"Allergies",title:"Allergies"}),re=null!=(re={moduleName:K})?re:{},Object.getOwnPropertyDescriptors?Object.defineProperties(te,Object.getOwnPropertyDescriptors(re)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r.push.apply(r,a)}return r}(Object(re)).forEach((function(e){Object.defineProperty(te,e,Object.getOwnPropertyDescriptor(re,e))})),te)),X),le=(0,a.getSyncLifecycle)((function(e){var t,r,n,l,s,_,g,m,u,f,y,C,h,v=e.closeWorkspace,b=e.patientUuid,E=(0,c.useTranslation)().t,D=(0,a.useConfig)().concepts,w="tablet"===(0,a.useLayoutType)(),k=[E("drug","Drug"),E("food","Food"),E("environmental","Environmental")],B=[E("mild","Mild"),E("moderate","Moderate"),E("severe","Severe")],S=(0,i.useMemo)((function(){return{patientUuid:b}}),[b]),O=(0,i.useMemo)((function(){return D}),[D]),z=O.mildReactionUuid,j=O.severeReactionUuid,R=O.moderateReactionUuid,F=O.otherConceptUuid,T=(r=(t=(0,a.useConfig)().concepts).drugAllergenUuid,n=t.environmentalAllergenUuid,l=t.foodAllergenUuid,s=t.allergyReactionUuid,_=x()("/ws/rest/v1/concept/".concat(r,"?v=full"),a.openmrsFetch).data,g=x()("/ws/rest/v1/concept/".concat(n,"?v=full"),a.openmrsFetch).data,m=x()("/ws/rest/v1/concept/".concat(l,"?v=full"),a.openmrsFetch).data,u=x()("/ws/rest/v1/concept/".concat(s,"?v=full"),a.openmrsFetch).data,y=(f=function(e){var t,r;return null==e||null===(r=e.data)||void 0===r||null===(t=r.setMembers)||void 0===t?void 0:t.map((function(e){return{uuid:e.uuid,display:e.display}}))})(_),C=f(g),h=f(m),{isLoading:!(_&&g&&m&&u),allergensAndAllergicReactions:{allergicReactions:f(u),drugAllergens:y,environmentalAllergens:C,foodAllergens:h}}),N=T.allergensAndAllergicReactions,U=T.isLoading,P=J((0,i.useState)(null),2),L=P[0],M=P[1],V=J((0,i.useState)(!0),2),Y=V[0],q=V[1],K=J((0,i.useState)("DRUG"),2),X=K[0],$=K[1],ee=p(b).mutate,te=(0,I.cI)({mode:"all",resolver:(0,H.F)(W),defaultValues:{allergicReactions:[]}}),re=te.control,ae=te.handleSubmit,ne=te.watch,le=(te.getValues,te.setValue),ie=ne("allergicReactions"),oe=ne("selectedAllergen"),se=ne("allergicReactions"),Ae=ne("severityOfWorstReaction"),ce=ne("nonCodedAllergenType"),de=ne("nonCodedAllergicReaction");(0,i.useEffect)((function(){var e=null==se?void 0:se.some((function(e){return""!==e}));q(!(oe&&e&&Ae))}),[se,ne,oe,Ae,F,ce]);var _e=(0,i.useCallback)((function(e){var t=e.comment,r=e.selectedAllergen,n=e.nonCodedAllergenType,l=e.nonCodedAllergicReaction,i=e.allergicReactions,o=e.severityOfWorstReaction,s=i.filter((function(e){return""!==e})),A={allergen:r===F?{allergenType:X,codedAllergen:{uuid:r},nonCodedAllergen:n}:{allergenType:X,codedAllergen:{uuid:r}},severity:{uuid:o},comment:t,reactions:null==s?void 0:s.map((function(e){return e===F?{reaction:{uuid:e},reactionNonCoded:l}:{reaction:{uuid:e}}}))},c=new AbortController;(function(e,t,r){return(0,a.openmrsFetch)("/ws/rest/v1/patient/".concat(t,"/allergy"),{headers:{"Content-Type":"application/json"},method:"POST",body:e,signal:r.signal})})(A,b,c).then((function(e){201===e.status&&(ee(),v(),(0,a.showToast)({critical:!0,kind:"success",title:E("allergySaved","Allergy saved"),description:E("allergyNowVisible","It is now visible on the Allergies page")}))}),(function(e){M(e),(0,a.showNotification)({title:E("allergySaveError","Error saving allergy"),kind:"error",critical:!0,description:null==e?void 0:e.message})})).finally((function(){return c.abort()}))}),[X,F,b,v,E,ee]);return o().createElement(d.l09,null,w?o().createElement(d.X2j,{className:G.header},o().createElement(a.ExtensionSlot,{className:G.content,name:"patient-details-header-slot",state:S})):null,o().createElement("div",{className:A()(G.form,w?G.tablet:G.desktop)},o().createElement("div",null,o().createElement("h1",{className:G.heading},E("allergensAndReactions","Allergens and reactions")),L?o().createElement(d.K0D,{style:{margin:"0rem",minWidth:"100%"},kind:"error",lowContrast:!0,title:E("errorFetchingData","Error fetching allergens and reactions"),subtitle:E("tryReopeningTheForm","Please try launching the form again")}):null,o().createElement("div",{className:A()(G.container,w?G.tabletContainer:G.desktopContainer)},o().createElement("section",{className:G.section},o().createElement("h2",{className:G.sectionHeading},E("selectAllergens","Select the allergens")),o().createElement(d.mQc,{onSelectionChange:function(e){switch(e){case 0:$("DRUG");break;case 1:$("FOOD");break;case 2:$("ENVIRONMENT")}}},o().createElement(d.tdY,{"aria-label":"Allergen tabs",className:G.tablist},k.map((function(e,t){return o().createElement(d.OK9,{className:G.tab,id:"tab-".concat(t+1),key:"allergen-tab-".concat(t)},e)}))),o().createElement(d.nPR,null,U?o().createElement(d.lSo,{style:{margin:"1rem"},description:"".concat(E("loading","Loading")," ...")}):k.map((function(e,t){var r=e.toLowerCase()+"Allergens";return o().createElement(d.x45,{key:"allergen-tab-panel-".concat(t)},o().createElement("div",{className:w?G.wrapperContainer:void 0},o().createElement(I.Qr,{name:"selectedAllergen",control:re,render:function(e){var a,n=e.field,l=n.onBlur,i=n.onChange,s=n.value;return o().createElement(d.SYO,{name:"allergen-type-".concat(t+1),key:r,orientation:"vertical",onChange:function(e){return i(e.toString())},valueSelected:s,onBlur:l},null==N||null===(a=N[r])||void 0===a?void 0:a.map((function(e,t){return o().createElement(d.EUY,{key:"allergen-".concat(t),className:G.radio,id:e.display,labelText:e.display,value:e.uuid})})))}})))})))),oe===F?o().createElement("div",{className:G.input},o().createElement(Z,{isTablet:w},o().createElement(I.Qr,{name:"nonCodedAllergenType",control:re,rules:{required:ne("selectedAllergen")===F},render:function(e){var t=e.field,r=t.onBlur,a=t.onChange,n=t.value,l=t.ref;return o().createElement(d.oil,{id:"nonCodedAllergenType",labelText:E("otherNonCodedAllergen","Other non-coded allergen"),onChange:a,onBlur:r,placeholder:E("typeAllergenName","Please type in the name of the allergen"),value:n,ref:l})}}))):null),o().createElement("section",{className:G.section},o().createElement("h2",{className:G.midSectionHeading},E("selectReactions","Select the reactions")),o().createElement("div",{className:w?G.checkboxContainer:void 0,style:{margin:"1rem"}},U?o().createElement(d.lSo,{description:"".concat(E("loading","Loading")," ...")}):o().createElement(Q,{allergensAndAllergicReactions:N,methods:{setValue:le,control:re}})),(null==ie?void 0:ie.includes(F))?o().createElement("div",{className:G.input},o().createElement(Z,{isTablet:w},o().createElement(I.Qr,{name:"nonCodedAllergicReaction",control:re,render:function(e){var t=e.field,r=t.onBlur,a=t.onChange,n=t.value;return o().createElement(d.oil,{id:"nonCodedAllergicReaction",labelText:E("otherNonCodedAllergicReaction","Other non-coded allergic reaction"),onChange:a,onBlur:r,value:n,placeholder:E("typeAllergicReactionName","Please type in the name of the allergic reaction")})}}))):null)),o().createElement("h1",{className:G.heading},E("severityAndOnsetDate","Severity and date of onset")),o().createElement("div",{className:A()(G.container,w?G.tabletContainer:G.desktopContainer)},o().createElement("section",{className:G.section},o().createElement("h2",{className:G.sectionHeading},E("severityOfWorstReaction","Severity of worst reaction")),o().createElement("div",{className:G.wrapper},o().createElement(I.Qr,{name:"severityOfWorstReaction",control:re,render:function(e){var t=e.field,r=t.onBlur,a=t.onChange,n=t.value;return o().createElement(d.SYO,{name:"severity-of-worst-reaction",onChange:function(e){return a(e.toString())},valueSelected:n,onBlur:r},B.map((function(e,t){return o().createElement(d.EUY,{id:e.toLowerCase()+"Severity",key:"severity-".concat(t),labelText:e,value:function(){switch(e.toLowerCase()){case"mild":return z;case"moderate":return R;case"severe":return j;default:return""}}()})})))}}))),o().createElement("section",{className:G.section},o().createElement("h2",{className:G.sectionHeading},E("onsetDateAndComments","Onset date and comments")),o().createElement("div",{className:G.wrapper},o().createElement(Z,{isTablet:w},o().createElement(I.Qr,{name:"comment",control:re,render:function(e){var t=e.field,r=t.onBlur,a=t.onChange,n=t.value;return o().createElement(d.Kx8,{cols:20,id:"comments",invalidText:E("invalidComment","Invalid comment, try again"),labelText:E("dateOfOnsetAndComments","Date of onset and comments"),onChange:a,placeholder:E("typeAdditionalComments","Type any additional comments here"),onBlur:r,value:n,rows:4})}})))))),o().createElement(d.uVA,{className:w?G.tabletButtons:G.desktopButtons},o().createElement(d.zxk,{className:G.button,onClick:v,kind:"secondary"},E("discard","Discard")),o().createElement(d.zxk,{className:G.button,disabled:Y||oe===F&&!ce||(null==se?void 0:se.includes(F))&&!de,onClick:ae(_e),kind:"primary"},E("saveAndClose","Save and close")))))}),X),ie=(0,a.getSyncLifecycle)((function(e){var t=e.patientUuid,r=(0,c.useTranslation)().t,a=p(t),n=a.allergies;return a.isLoading?o().createElement(d.lSo,{role:"progressbar",description:"".concat(r("loading","Loading")," ...")}):(null==n?void 0:n.length)?o().createElement("div",null,o().createElement("p",{className:Y.label},r("allergies","Allergies")),o().createElement("p",{className:Y.content},o().createElement("span",{className:Y.value},null==n?void 0:n.map((function(e){return null==e?void 0:e.display})).join(", ")))):o().createElement("div",null,o().createElement("p",{className:Y.label},r("allergies","Allergies")),o().createElement("p",{className:Y.content},"--"))}),X)},3979:(e,t,r)=>{var a={"./am.json":[8788,788],"./ar.json":[4460,460],"./en.json":[3574,574],"./es.json":[8319,319],"./fr.json":[2757,757],"./he.json":[5833,833],"./km.json":[7807,807]};function n(e){if(!r.o(a,e))return Promise.resolve().then((()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=a[e],n=t[0];return r.e(t[1]).then((()=>r(n)))}n.keys=()=>Object.keys(a),n.id=3979,e.exports=n}}]);