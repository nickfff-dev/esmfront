"use strict";(globalThis.webpackChunk_openmrs_esm_service_queues_app=globalThis.webpackChunk_openmrs_esm_service_queues_app||[]).push([[425],{9992:(e,t,n)=>{n.d(t,{Z:()=>u});var i=n(272),a=n.n(i),s=n(2609),o=n.n(s)()(a());o.push([e.id,".-esm-service-queues__transition-queue-entry-dialog__modalBody___C0CJU{padding-bottom:.5rem;margin-bottom:0rem}.-esm-service-queues__transition-queue-entry-dialog__p___mzejr{margin-bottom:.25rem;font-size:var(--cds-body-01-font-size, 0.875rem);font-weight:var(--cds-body-01-font-weight, 400);line-height:var(--cds-body-01-line-height, 1.42857);letter-spacing:var(--cds-body-01-letter-spacing, 0.16px)}","",{version:3,sources:["webpack://./src/transition-queue-entry/transition-queue-entry-dialog.scss","webpack://./../../node_modules/@carbon/layout/scss/generated/_spacing.scss","webpack://./../../node_modules/@carbon/type/scss/_styles.scss"],names:[],mappings:"AAGA,uEACE,oBCiBW,CDhBX,kBAAA,CAGF,+DACE,oBCOW,CCk1BT,gDAAA,CAAA,+CAAA,CAAA,mDAAA,CAAA,wDAAA",sourceRoot:""}]),o.locals={modalBody:"-esm-service-queues__transition-queue-entry-dialog__modalBody___C0CJU",p:"-esm-service-queues__transition-queue-entry-dialog__p___mzejr"};const u=o},6425:(e,t,n)=>{n.r(t),n.d(t,{default:()=>T});var i=n(5206),a=n.n(i),s=n(8879),o=n.n(s),u=n(4924),l=n(3028),r=n(2870),c=n(8053),d=n(8702),m=n(5865),p=n(3069),v=n(1354),g=n.n(v),y=n(1583),_=n.n(y),f=n(7378),A=n.n(f),E=n(5993),h=n.n(E),C=n(4154),q=n.n(C),b=n(8141),U=n.n(b),k=n(9992),w={};w.styleTagTransform=U(),w.setAttributes=h(),w.insert=A().bind(null,"head"),w.domAPI=_(),w.insertStyleElement=q(),g()(k.Z,w);const D=k.Z&&k.Z.locals?k.Z.locals:void 0;var N;!function(e){e.REQUEUED="Requeued"}(N||(N={}));const T=function(e){var t=e.queueEntry,n=e.closeModal,s=(0,u.useTranslation)().t,v=(0,r.useConfig)(),g=v.concepts.defaultTransitionStatus,y=null==t?void 0:t.identifiers.filter((function(e){var t;return v.defaultIdentifierTypes.includes(null==e||null===(t=e.identifierType)||void 0===t?void 0:t.uuid)})),_=o()((new Date).toISOString()).subtract(6,"month").toISOString(),f=(0,p.Wi)(null==t?void 0:t.patientUuid,_),A=f.upcomingAppointment,E=f.isLoading,h=(0,m.N)(null==t?void 0:t.patientUuid),C=h.visits,q=h.isLoading,b=!q&&C?(0,d.wP)(null==C?void 0:C.encounters,v.concepts.historicalObsConceptUuid):[],U=(0,c.P4)("","").mutate,k=(0,i.useCallback)((function(){var e=new Date;(0,c.zI)(null==t?void 0:t.visitUuid,null==t?void 0:t.queueUuid,null==t?void 0:t.queueUuid,null==t?void 0:t.queueEntryUuid,null==t?void 0:t.patientUuid,null==t?void 0:t.priorityUuid,g,e,null==t?void 0:t.sortWeight).then((function(e){201===e.status&&(0,c.Ny)(null==t?void 0:t.service,null==t?void 0:t.visitQueueNumber,"serving").then((function(e){200===e.status&&((0,r.showToast)({critical:!0,title:s("success","Success"),kind:"success",description:s("patientAttendingService","Patient attending service")}),n(),U(),(0,r.navigate)({to:"${openmrsSpaBase}/patient/".concat(null==t?void 0:t.patientUuid,"/chart")}))}))}),(function(e){(0,r.showNotification)({title:s("queueEntryUpdateFailed","Error updating queue entry"),kind:"error",critical:!0,description:null==e?void 0:e.message})}))}),[t]),w=(0,i.useCallback)((function(){(function(e,t,n){var i=new AbortController;return(0,r.openmrsFetch)("/ws/rest/v1/queue/".concat(t,"/entry/").concat(n),{method:"POST",headers:{"Content-Type":"application/json"},signal:i.signal,body:{priorityComment:e}})})(N.REQUEUED,null==t?void 0:t.queueUuid,null==t?void 0:t.queueEntryUuid).then((function(e){200===e.status&&((0,r.showToast)({critical:!0,title:s("success","Success"),kind:"success",description:s("patientRequeued","Patient has been requeued")}),n(),U())}),(function(e){(0,r.showNotification)({title:s("queueEntryUpdateFailed","Error updating queue entry"),kind:"error",critical:!0,description:null==e?void 0:e.message})}))}),[]);return a().createElement("div",null,a().createElement(l.xBx,{closeModal:n,title:s("servePatient","Serve patient")}),a().createElement(l.fef,{className:D.modalBody},a().createElement("div",null,a().createElement("section",{className:D.modalBody},a().createElement("p",{className:D.p},s("patientName","Patient name")," :   ",null==t?void 0:t.name),(null==y?void 0:y.length)?y.map((function(e){var t;return a().createElement("p",{className:D.p},null==e||null===(t=e.identifierType)||void 0===t?void 0:t.display," :   ",null==e?void 0:e.identifier)})):"",a().createElement("p",{className:D.p},s("lastClinicalVisit","Last clinical visit")," :   ",q&&s("loading","Loading..."),!q&&!C&&s("none","None"),C&&(0,r.formatDatetime)((0,r.parseDate)(null==C?void 0:C.startDatetime))),(null==b?void 0:b.length)?b.map((function(e){return a().createElement("p",{className:D.p},e.concept.display," :   ",e.value.display)})):"",a().createElement("p",{className:D.p},s("tcaDate","Tca date")," :   ",E&&s("loading","Loading..."),!E&&!A&&s("none","None"),A&&(0,r.formatDatetime)((0,r.parseDate)(null==A?void 0:A.startDateTime)))),a().createElement(r.ExtensionSlot,{className:D.visitSummaryContainer,name:"previous-visit-summary-slot",state:{patientUuid:null==t?void 0:t.patientUuid}}))),a().createElement(l.mzw,null,a().createElement(l.zxk,{kind:"secondary",onClick:function(){return w()}},s("requeue","Requeue")),a().createElement(l.zxk,{onClick:function(){return k()}},s("serve","Serve"))))}}}]);