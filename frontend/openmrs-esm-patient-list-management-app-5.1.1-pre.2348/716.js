"use strict";(globalThis.webpackChunk_openmrs_esm_patient_list_management_app=globalThis.webpackChunk_openmrs_esm_patient_list_management_app||[]).push([[716],{7729:(e,t,n)=>{n.d(t,{Z:()=>o});var a=n(272),i=n.n(a),r=n(2609),s=n.n(r)()(i());s.push([e.id,":root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79}.-esm-patient-list-management__add-patient__productiveHeading02___Tg4Ke{font-size:var(--cds-heading-compact-02-font-size, 1rem);font-weight:var(--cds-heading-compact-02-font-weight, 600);line-height:var(--cds-heading-compact-02-line-height, 1.375);letter-spacing:var(--cds-heading-compact-02-letter-spacing, 0)}.-esm-patient-list-management__add-patient__productiveHeading03___ZLZfS{font-size:var(--cds-heading-03-font-size, 1.25rem);font-weight:var(--cds-heading-03-font-weight, 400);line-height:var(--cds-heading-03-line-height, 1.4);letter-spacing:var(--cds-heading-03-letter-spacing, 0)}.-esm-patient-list-management__add-patient__productiveHeading04___IJa64{font-size:var(--cds-heading-04-font-size, 1.75rem);font-weight:var(--cds-heading-04-font-weight, 400);line-height:var(--cds-heading-04-line-height, 1.28572);letter-spacing:var(--cds-heading-04-letter-spacing, 0)}.-esm-patient-list-management__add-patient__bodyLong01___kZia8{font-size:var(--cds-body-01-font-size, 0.875rem);font-weight:var(--cds-body-01-font-weight, 400);line-height:var(--cds-body-01-line-height, 1.42857);letter-spacing:var(--cds-body-01-letter-spacing, 0.16px)}.-esm-patient-list-management__add-patient__bodyShort01___nA8Cw{font-size:var(--cds-body-compact-01-font-size, 0.875rem);font-weight:var(--cds-body-compact-01-font-weight, 400);line-height:var(--cds-body-compact-01-line-height, 1.28572);letter-spacing:var(--cds-body-compact-01-letter-spacing, 0.16px)}.-esm-patient-list-management__add-patient__bodyShort02___nmEwy{font-size:var(--cds-body-compact-02-font-size, 1rem);font-weight:var(--cds-body-compact-02-font-weight, 400);line-height:var(--cds-body-compact-02-line-height, 1.375);letter-spacing:var(--cds-body-compact-02-letter-spacing, 0)}.-esm-patient-list-management__add-patient__text02___LHem6{color:#525252}.-esm-patient-list-management__add-patient__label01___GtOx4{font-size:var(--cds-label-01-font-size, 0.75rem);font-weight:var(--cds-label-01-font-weight, 400);line-height:var(--cds-label-01-line-height, 1.33333);letter-spacing:var(--cds-label-01-letter-spacing, 0.32px)}.-esm-patient-list-management__add-patient__modal___o88NP{position:fixed;width:100vw;height:100vh;display:grid;background-color:rgba(0,0,0,.5);z-index:9000;justify-items:center;align-items:center}.-esm-patient-list-management__add-patient__modalContent___AWM2H{width:100%;background-color:#f4f4f4}.-esm-patient-list-management__add-patient__modalHeader___C25Zv{margin:1rem}.-esm-patient-list-management__add-patient__patientListList___hlyTd{padding:0 1rem}.-esm-patient-list-management__add-patient__checkbox___KWZkw{padding-bottom:.875rem}.-esm-patient-list-management__add-patient__pagination___qvsDi{width:100%;overflow:hidden}.-esm-patient-list-management__add-patient__paginationContainer___KJmP9{display:flex;justify-content:space-between;align-items:center;position:relative}.-esm-patient-list-management__add-patient__itemsCountDisplay___jAW9C{position:absolute;top:0;left:1rem;height:3rem;display:flex;align-items:center;color:#525252}.-esm-patient-list-management__add-patient__pagination___qvsDi>div:first-child{visibility:hidden;width:0}.-esm-patient-list-management__add-patient__buttonSet___snp28{display:flex;justify-content:space-between;align-items:flex-start}","",{version:3,sources:["webpack://./../../node_modules/@openmrs/esm-styleguide/src/_vars.scss","webpack://./src/style.scss","webpack://./../../node_modules/@carbon/type/scss/_styles.scss","webpack://./src/add-patient/add-patient.scss"],names:[],mappings:"AAoDA,MACE,mBAAA,CACA,mBAAA,CACA,mBAAA,CCnDF,wEC81BI,uDAAA,CAAA,0DAAA,CAAA,4DAAA,CAAA,8DAAA,CD11BJ,wEC01BI,kDAAA,CAAA,kDAAA,CAAA,kDAAA,CAAA,sDAAA,CDt1BJ,wECs1BI,kDAAA,CAAA,kDAAA,CAAA,sDAAA,CAAA,sDAAA,CDl1BJ,+DCk1BI,gDAAA,CAAA,+CAAA,CAAA,mDAAA,CAAA,wDAAA,CD90BJ,gEC80BI,wDAAA,CAAA,uDAAA,CAAA,2DAAA,CAAA,gEAAA,CD10BJ,gEC00BI,oDAAA,CAAA,uDAAA,CAAA,yDAAA,CAAA,2DAAA,CDt0BJ,2DACE,aDxBQ,CC2BV,4DCk0BI,gDAAA,CAAA,gDAAA,CAAA,oDAAA,CAAA,yDAAA,CD9zBJ,0DACE,cAAA,CACA,WAAA,CACA,YAAA,CACA,YAAA,CACA,+BAAA,CACA,YAAA,CACA,oBAAA,CACA,kBAAA,CE1CF,iEACE,UAAA,CACA,wBAAA,CAGF,gEACE,WAAA,CAGF,oEACE,cAAA,CAGF,6DACE,sBAAA,CAGF,+DACE,UAAA,CACA,eAAA,CAGF,wEACE,YAAA,CACA,6BAAA,CACA,kBAAA,CACA,iBAAA,CAGF,sEACE,iBAAA,CACA,KAAA,CACA,SAAA,CACA,WAAA,CACA,YAAA,CACA,kBAAA,CACA,aAAA,CAGF,+EACE,iBAAA,CACA,OAAA,CAGF,8DACE,YAAA,CACA,6BAAA,CACA,sBAAA",sourceRoot:""}]),s.locals={productiveHeading02:"-esm-patient-list-management__add-patient__productiveHeading02___Tg4Ke",productiveHeading03:"-esm-patient-list-management__add-patient__productiveHeading03___ZLZfS",productiveHeading04:"-esm-patient-list-management__add-patient__productiveHeading04___IJa64",bodyLong01:"-esm-patient-list-management__add-patient__bodyLong01___kZia8",bodyShort01:"-esm-patient-list-management__add-patient__bodyShort01___nA8Cw",bodyShort02:"-esm-patient-list-management__add-patient__bodyShort02___nmEwy",text02:"-esm-patient-list-management__add-patient__text02___LHem6",label01:"-esm-patient-list-management__add-patient__label01___GtOx4",modal:"-esm-patient-list-management__add-patient__modal___o88NP",modalContent:"-esm-patient-list-management__add-patient__modalContent___AWM2H",modalHeader:"-esm-patient-list-management__add-patient__modalHeader___C25Zv",patientListList:"-esm-patient-list-management__add-patient__patientListList___hlyTd",checkbox:"-esm-patient-list-management__add-patient__checkbox___KWZkw",pagination:"-esm-patient-list-management__add-patient__pagination___qvsDi",paginationContainer:"-esm-patient-list-management__add-patient__paginationContainer___KJmP9",itemsCountDisplay:"-esm-patient-list-management__add-patient__itemsCountDisplay___jAW9C",buttonSet:"-esm-patient-list-management__add-patient__buttonSet___snp28"};const o=s},716:(e,t,n)=>{n.r(t),n.d(t,{default:()=>j,useAddablePatientLists:()=>z});var a=n(268),i=n.n(a),r=n(2779),s=n.n(r),o=n(4924),l=n(3255),c=n(7987),d=n(2870),A=n(2565),m=n(1354),_=n.n(m),p=n(1583),u=n.n(p),g=n(7378),f=n.n(g),h=n(5993),C=n.n(h),y=n(4154),b=n.n(y),v=n(8141),w=n.n(v),E=n(7729),D={};D.styleTagTransform=w(),D.setAttributes=C(),D.insert=f().bind(null,"head"),D.domAPI=u(),D.insertStyleElement=b(),_()(E.Z,D);const k=E.Z&&E.Z.locals?E.Z.locals:void 0;function x(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function S(e,t,n,a,i,r,s){try{var o=e[r](s),l=o.value}catch(e){return void n(e)}o.done?t(l):Promise.resolve(l).then(a,i)}function B(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function s(e){S(r,a,i,s,o,"next",e)}function o(e){S(r,a,i,s,o,"throw",e)}s(void 0)}))}}function L(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,i,r=[],s=!0,o=!1;try{for(n=n.call(e);!(s=(a=n.next()).done)&&(r.push(a.value),!t||r.length!==t);s=!0);}catch(e){o=!0,i=e}finally{try{s||null==n.return||n.return()}finally{if(o)throw i}}return r}}(e,t)||N(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function T(e){return function(e){if(Array.isArray(e))return x(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||N(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function N(e,t){if(e){if("string"==typeof e)return x(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?x(e,t):void 0}}var P=function(e,t){var n,a,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function o(r){return function(o){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,a=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){s=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){s.label=r[1];break}if(6===r[0]&&s.label<i[1]){s.label=i[1],i=r;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(r);break}i[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,o])}}};function z(e){var t=(0,o.useTranslation)().t,n=(0,d.useConfig)();return(0,l.ZP)(["addablePatientLists",e],B((function(){var a,i,r;return P(this,(function(s){switch(s.label){case 0:return[4,Promise.allSettled([J(e,t),I(e,n.myListCohortTypeUUID,n.systemListCohortTypeUUID)])];case 1:return a=L.apply(void 0,[s.sent(),2]),i=a[0],r=a[1],[2,T("fulfilled"===i.status?i.value:[]).concat(T("fulfilled"===r.status?r.value:[]))]}}))})))}function I(e,t,n){return H.apply(this,arguments)}function H(){return(H=B((function(e,t,n){var a,i,r;return P(this,(function(s){switch(s.label){case 0:return[4,Promise.all([(0,A.SA)({},t,n),(0,A.U6)(e)])];case 1:return a=L.apply(void 0,[s.sent(),2]),i=a[0],r=a[1],[2,i.map((function(t){return{id:t.id,displayName:t.display,checked:r.includes(t.id),addPatient:function(){return B((function(){return P(this,(function(n){switch(n.label){case 0:return[4,(0,A.xj)({cohort:t.id,patient:e,startDate:(0,d.toOmrsIsoString)(new Date)})];case 1:return n.sent(),[2]}}))}))()}}}))]}}))}))).apply(this,arguments)}function J(e,t){return Z.apply(this,arguments)}function Z(){return(Z=B((function(e,t){return P(this,(function(n){switch(n.label){case 0:return[4,(0,d.getDynamicOfflineDataEntries)("patient")];case 1:return[2,n.sent().some((function(t){return t.identifier===e}))?[]:[{id:"fake-offline-patient-list",displayName:t("offlinePatients","Offline patients"),addPatient:function(){return B((function(){return P(this,(function(t){switch(t.label){case 0:return[4,(0,d.putDynamicOfflineData)("patient",e)];case 1:return t.sent(),[4,(0,d.syncDynamicOfflineData)("patient",e)];case 2:return t.sent(),[2]}}))}))()}}]]}}))}))).apply(this,arguments)}const j=function(e){var t=e.closeModal,n=e.patientUuid,r=(0,o.useTranslation)().t,l=L((0,a.useState)(""),2),A=l[0],m=l[1],_=L((0,a.useState)([]),2),p=_[0],u=_[1],g=z(n),f=g.data,h=g.isLoading,C=(0,a.useCallback)((function(e,t){u(t?function(t){return T(t).concat([e])}:function(t){return t.filter((function(t){return t!==e}))})}),[]),y=(0,a.useCallback)((function(){var e=!0,n=!1,a=void 0;try{for(var i,s=function(){var e=i.value,t=f.find((function(t){return t.id===e}));if(!t)return"continue";t.addPatient().then((function(){return(0,d.showToast)({title:r("successfullyAdded","Successfully added"),kind:"success",description:"".concat(r("successAddPatientToList","Patient added to list"),": ").concat(t.displayName)})})).catch((function(){return(0,d.showToast)({title:r("error","Error"),kind:"error",description:"".concat(r("errorAddPatientToList","Patient not added to list"),": ").concat(t.displayName)})}))},o=p[Symbol.iterator]();!(e=(i=o.next()).done);e=!0)s()}catch(e){n=!0,a=e}finally{try{e||null==o.return||o.return()}finally{if(n)throw a}}t()}),[f,p,t,r]),b=(0,a.useMemo)((function(){if(!f)return[];if((null==A?void 0:A.trim().length)>0){var e=A.toLowerCase();return f.filter((function(t){return t.displayName.toLowerCase().includes(e)}))}return f}),[A,f]),v=(0,d.usePagination)(b,5),w=v.results,E=v.goTo,D=v.currentPage,x=v.paginated;return(0,a.useEffect)((function(){1!==D&&E(1)}),[A]),i().createElement("div",{className:k.modalContent},i().createElement("div",{className:k.modalHeader},i().createElement("h1",{className:k.productiveHeading03},r("addPatientToList","Add patient to list")),i().createElement("h3",{className:k.bodyLong01,style:{margin:"1rem 0"}},r("searchForAListToAddThisPatientTo","Search for a list to add this patient to."))),i().createElement("div",{style:{marginBottom:"0.875rem"}},i().createElement(c.olm,{style:{backgroundColor:"white",borderBottom:"1px solid #e0e0e0"},labelText:r("searchForList","Search for a list"),placeholder:"Filter list",onChange:function(e){var t=e.target;m(t.value)},value:A})),i().createElement("div",{className:k.patientListList},i().createElement("fieldset",{className:"cds--fieldset"},i().createElement("p",{className:"cds--label"},r("patientLists","Patient lists")),!h&&w?w.length>0?w.map((function(e){return i().createElement("div",{key:e.id,className:k.checkbox},i().createElement(c.XZJ,{key:e.id,onChange:function(t){return C(e.id,t.target.checked)},checked:e.checked||p.includes(e.id),disabled:e.checked,labelText:e.displayName,id:e.id}))})):i().createElement("p",{className:k.bodyLong01},r("noPatientListFound","No patient list found")):i().createElement(i().Fragment,null,i().createElement("div",{className:k.checkbox},i().createElement(c.jJq,null)),i().createElement("div",{className:k.checkbox},i().createElement(c.jJq,null)),i().createElement("div",{className:k.checkbox},i().createElement(c.jJq,null)),i().createElement("div",{className:k.checkbox},i().createElement(c.jJq,null)),i().createElement("div",{className:k.checkbox},i().createElement(c.jJq,null))))),x&&i().createElement("div",{className:k.paginationContainer},i().createElement("span",{className:s()(k.itemsCountDisplay,k.bodyLong01)},w.length*D," / ",b.length," ",r("items","items")),i().createElement(c.tlE,{className:k.pagination,forwardText:"",backwardText:"",page:D,pageSize:5,pageSizes:[5],totalItems:b.length,onChange:function(e){var t=e.page;return E(t)}})),i().createElement("div",{className:k.buttonSet},i().createElement(c.zxk,{kind:"ghost",size:"xl",onClick:function(){(0,d.navigate)({to:window.getOpenmrsSpaBase()+"home/patient-lists?new_cohort=true"}),t()}},r("createNewPatientList","Create new patient list")),i().createElement("div",null,i().createElement(c.zxk,{kind:"secondary",size:"xl",onClick:t},r("cancel","Cancel")),i().createElement(c.zxk,{onClick:y,size:"xl"},r("addToList","Add to list")))))}}}]);